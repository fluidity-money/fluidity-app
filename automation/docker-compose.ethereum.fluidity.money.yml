---
version: "3"

services:
  ethereum.fluidity.money-frontend:
    build:
      context: ../web/ethereum.fluidity.money
      dockerfile: Dockerfile.frontend
      args:
        REACT_APP_API_URL: ${FLU_ETHEREUM_FRONTEND_API_URL}
        REACT_APP_WALLET_CONNECT_GETH_URI: ${FLU_ETHEREUM_FRONTEND_GETH_URL}
        REACT_APP_WEBSOCKET: ${FLU_ETHEREUM_FRONTEND_WS_URL}
        REACT_APP_CHAIN_ID: ${FLU_ETHEREUM_FRONTEND_CHAIN_ID}
        REACT_APP_WALLET_CONNECT_GETH_URI: ${FLU_ETHEREUM_FRONTEND_GETH_URL}
        REACT_APP_TOKEN_CONFIG_FILE: ${FLU_ETHEREUM_FRONTEND_TOKEN_FILE}
        REACT_APP_SENTRY_DSN: ${FLU_SENTRY_URL}
    ports:
      - 127.0.0.1:8080:80

  ethereum.fluidity.money-backend:
    build:
      context: ../web/ethereum.fluidity.money
      dockerfile: Dockerfile.backend
    env_file: ./docker-compose-envs
    environment:
      FLU_WORKER_ID: ${FLU_UNIVERSE}-ethereum.fluidity.money-backend
      FLU_SENTRY_URL: ${FLU_SENTRY_URL}
      FLU_AMQP_QUEUE_ADDR: ${FLU_AMQP_QUEUE_ADDR}
      FLU_ETHEREUM_WORKER_PRIVATE_KEY_LIST: ${FLU_ETHEREUM_WORKER_PRIVATE_KEY_LIST}
    ports:
      - 127.0.0.1:8081:80
    restart: unless-stopped
